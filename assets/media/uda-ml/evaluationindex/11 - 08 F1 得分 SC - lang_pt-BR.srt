1
00:00:00,400 --> 00:00:03,967
Nós vimos precisão e recall
no modelo médico,

2
00:00:04,000 --> 00:00:09,233
que tinha precisão de 55.7%
e recall de 83,3%.

3
00:00:09,267 --> 00:00:11,367
Ele é um modelo
de alto recall.

4
00:00:11,400 --> 00:00:15,033
O detector de spam tinha
precisão de 76.9%

5
00:00:15,067 --> 00:00:16,567
e recall de 37%,

6
00:00:16,600 --> 00:00:18,933
ele é um modelo
de alta precisão.

7
00:00:18,967 --> 00:00:22,867
Mas nós queremos
os dois valores sempre?

8
00:00:22,900 --> 00:00:24,700
Queremos a precisão
em um bolso

9
00:00:24,733 --> 00:00:25,933
e o recall no outro

10
00:00:25,967 --> 00:00:28,967
e observar o dois
na hora de tomar a decisão?

11
00:00:29,000 --> 00:00:30,167
Isso é inconveniente.

12
00:00:30,200 --> 00:00:33,967
Nós queremos ter
um escore único.

13
00:00:34,000 --> 00:00:38,200
Então como combinamos
os dois em um?

14
00:00:38,233 --> 00:00:39,833
Existe uma maneira?

15
00:00:41,133 --> 00:00:45,500
Uma maneira é fazer a média
entre precisão e recall.

16
00:00:45,533 --> 00:00:51,033
À esquerda, temos 69.5%,
à direita, 56.95%.

17
00:00:51,067 --> 00:00:54,400
Esta é uma métrica boa, mas você
deve estar se perguntando:

18
00:00:54,433 --> 00:00:56,767
"isso não é tão diferente
da precisão.

19
00:00:56,800 --> 00:00:58,567
Isso não diz muita coisa."

20
00:00:58,600 --> 00:01:01,100
Para ver como a média
não é a melhor escolha,

21
00:01:01,133 --> 00:01:04,467
vamos ver exemplos extremos
como o de fraude de cartões.

22
00:01:04,500 --> 00:01:07,633
Temos transações boas
e fraudulentas

23
00:01:07,667 --> 00:01:10,067
e vamos escolher o modelo
ruim que diz

24
00:01:10,100 --> 00:01:11,967
que todas as transações
são boas.

25
00:01:12,000 --> 00:01:13,867
Qual é a precisão
deste modelo?

26
00:01:13,900 --> 00:01:16,933
A precisão dirá,
dos classificados como ruins,

27
00:01:16,967 --> 00:01:18,733
quantos são ruins mesmo?

28
00:01:18,767 --> 00:01:22,133
Esse é valor ruim, pois não
rotulamos nada como fraudulento.

29
00:01:22,167 --> 00:01:24,867
É como dividir zero por zero,
é indefinido.

30
00:01:24,900 --> 00:01:27,933
Mas faz sentido pensar
em 100%, não é?

31
00:01:27,967 --> 00:01:31,467
Como temos zero erro
entre os positivos,

32
00:01:31,500 --> 00:01:33,900
que é o que a precisão
tenta medir.

33
00:01:33,933 --> 00:01:36,367
Digamos que este modelo
tem precisão de 100%.

34
00:01:36,400 --> 00:01:41,867
O recall quer saber quantas
fraudes detectamos.

35
00:01:41,900 --> 00:01:43,533
Como nós
não detectamos nenhuma,

36
00:01:43,567 --> 00:01:45,167
o valor é zero.

37
00:01:45,200 --> 00:01:48,067
A média entre precisão
e recall é de 50%,

38
00:01:48,100 --> 00:01:50,767
pois é a média
entre 100 e zero.

39
00:01:50,800 --> 00:01:55,167
Eu quero dar a este modelo
péssimo o valor de 50%?

40
00:01:55,200 --> 00:01:58,133
É um valor alto
para um modelo ruim.

41
00:01:58,167 --> 00:02:01,067
Ele deve ter um valor menor,
talvez até zero.

42
00:02:01,100 --> 00:02:02,867
Então a média não é tão boa.

43
00:02:02,900 --> 00:02:07,467
Vamos ver o modelo que diz
que todas são fraudulentas.

44
00:02:07,500 --> 00:02:09,933
Qual é a precisão
deste modelo?

45
00:02:09,967 --> 00:02:12,633
De todas as transações
que são fraudulentas,

46
00:02:12,667 --> 00:02:15,633
472 eram realmente
fraudulentas.

47
00:02:15,667 --> 00:02:20,700
Então a precisão era de 472
dividida por 284.807

48
00:02:20,733 --> 00:02:22,733
que dá 0,16%.

49
00:02:22,767 --> 00:02:27,567
O recall é bom, porque
das 472 fraudes

50
00:02:27,600 --> 00:02:29,033
eu detectei todas.

51
00:02:29,067 --> 00:02:32,000
O recall será 472
dividido por 472,

52
00:02:32,033 --> 00:02:33,967
que é igual a 100%.

53
00:02:34,000 --> 00:02:37,400
A média dos dois é a média
entre 0.16% e 100%,

54
00:02:37,433 --> 00:02:39,600
que é de 50,08%.

55
00:02:39,633 --> 00:02:41,933
É um escore alto
para um modelo ruim.

56
00:02:41,967 --> 00:02:45,100
O escore deveria
ser próximo ao zero.

57
00:02:45,133 --> 00:02:48,467
A média não é a melhor prática,
a princípio,

58
00:02:48,500 --> 00:02:51,100
se a precisão ou o recall
forem muito baixos.

59
00:02:51,133 --> 00:02:52,867
Nós queremos que o valor
seja baixo

60
00:02:52,900 --> 00:02:54,567
mesmo que o outro seja alto.

61
00:02:54,600 --> 00:02:56,467
Esta é a solução,

62
00:02:56,500 --> 00:02:59,533
existe outro tipo de média
chamada de média harmônica,

63
00:02:59,567 --> 00:03:01,033
que funciona assim:

64
00:03:01,067 --> 00:03:03,200
digamos que nós temos
dois números X e Y,

65
00:03:03,233 --> 00:03:05,233
sendo que X é menor que Y,

66
00:03:05,267 --> 00:03:08,367
e a média aritmética
está aqui.

67
00:03:08,400 --> 00:03:11,767
Esta é a média de X mais Y
dividido por 2.

68
00:03:11,800 --> 00:03:14,767
E temos a média harmônica,
que é definida

69
00:03:14,800 --> 00:03:18,467
por duas vezes X vezes Y
dividido por X mais Y.

70
00:03:18,500 --> 00:03:21,300
Isto é uma média, pois
se os números forem iguais,

71
00:03:21,333 --> 00:03:22,900
nós teremos X ou Y,

72
00:03:22,933 --> 00:03:25,400
que sempre estará
entre X e Y,

73
00:03:25,433 --> 00:03:28,200
mas é um fato matemático
que a média harmônica

74
00:03:28,233 --> 00:03:31,100
é sempre menor
que a média aritmética.

75
00:03:31,133 --> 00:03:34,867
Ela está mais próxima
do menor número do que do maior.

76
00:03:34,900 --> 00:03:38,433
Com precisão igual a um
e recall igual a zero,

77
00:03:38,467 --> 00:03:40,500
a média é de 0,5,

78
00:03:40,533 --> 00:03:43,167
mas a média harmônica,
utilizando a fórmula,

79
00:03:43,200 --> 00:03:44,500
será igual a zero.

80
00:03:44,533 --> 00:03:48,667
Com precisão igual a 0,2
e recall igual a 0,8,

81
00:03:48,700 --> 00:03:50,600
a média aritmética
será igual a 0,5,

82
00:03:50,633 --> 00:03:52,800
mas a harmônica
será igual a 0,32.

83
00:03:52,833 --> 00:03:55,133
Ela fica mais próxima
do valor mais baixo.

84
00:03:55,167 --> 00:03:58,400
Nós não utilizamos a média
ou a média aritmética,

85
00:03:58,433 --> 00:04:00,633
mas a média harmônica.

86
00:04:00,667 --> 00:04:03,167
Isso será chamado
de F1-Score.

87
00:04:03,200 --> 00:04:06,100
O F1-Score é mais próximo
do menor valor

88
00:04:06,133 --> 00:04:08,100
entre a precisão e o recall.

89
00:04:08,133 --> 00:04:12,967
Se um for muito baixo,
o F1-Score sinalizará.

90
00:04:13,000 --> 00:04:15,967
A média diz que se um for bom,
mas o outro for ruim,

91
00:04:16,000 --> 00:04:17,433
isso funciona,

92
00:04:17,467 --> 00:04:21,200
mas o F1-Score sinaliza
quando um deles for pequeno.

93
00:04:21,233 --> 00:04:23,567
No exemplo de fraude
de cartão de crédito,

94
00:04:23,600 --> 00:04:25,300
vamos calcular o F1-Score.

95
00:04:25,333 --> 00:04:29,067
Teremos a média harmônica
entre a precisão de 100%

96
00:04:29,100 --> 00:04:30,900
e o recall de zero.

97
00:04:30,933 --> 00:04:34,733
Com a fórmula obtemos
F1-Score igual a zero.

98
00:04:34,767 --> 00:04:37,500
Isso é mais próximo do que
o modelo deve ter de escore.

99
00:04:37,533 --> 00:04:40,467
Nos próximos dois questionários,
você calculará o F1-Score

100
00:04:40,500 --> 00:04:43,333
do modelo médico
e de e-mail spam.

