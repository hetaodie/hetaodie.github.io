1
00:00:00,000 --> 00:00:02,560
下面总结下机器学习的过程

2
00:00:02,560 --> 00:00:05,580
首先用训练数据训练一堆模型

3
00:00:05,580 --> 00:00:09,589
然后使用交叉验证数据挑选最佳模型

4
00:00:09,589 --> 00:00:13,144
最后 使用测试数据测试模型是否很好

5
00:00:13,144 --> 00:00:16,239
下面举个训练逻辑回归模型的例子

6
00:00:16,239 --> 00:00:18,274
假设有四个模型

7
00:00:18,274 --> 00:00:19,964
第一个是一次模型

8
00:00:19,964 --> 00:00:24,425
是一条直线 然后是二次 三次 四次

9
00:00:24,425 --> 00:00:26,190
我们使用训练数据训练它们

10
00:00:26,190 --> 00:00:29,130
并算出多项式的斜率和系数等等

11
00:00:29,129 --> 00:00:34,564
然后使用交叉验证数据计算所有这些模型的 F1 得分

12
00:00:34,564 --> 00:00:38,259
然后选择 F1 得分最高的模型

13
00:00:38,259 --> 00:00:42,570
最后 使用测试数据确保模型效果很好

14
00:00:42,570 --> 00:00:46,259
因此这里的算法参数就是多项式的系数

15
00:00:46,259 --> 00:00:50,189
但是多项式的次数就像物性参数

16
00:00:50,189 --> 00:00:52,859
我们称之为超参数

17
00:00:52,859 --> 00:00:54,089
我们再看一个示例

18
00:00:54,090 --> 00:00:55,580
假设我们要训练一个决策树

19
00:00:55,579 --> 00:00:57,390
超参数是什么？

20
00:00:57,390 --> 00:01:00,615
其中一个是深度 假设深度是 1

21
00:01:00,615 --> 00:01:02,825
2 3 和 4

22
00:01:02,825 --> 00:01:06,765
我们使用训练数据训练深度为 1 2 3 和 4 的

23
00:01:06,765 --> 00:01:09,420
决策树

24
00:01:09,420 --> 00:01:13,519
参数是树叶和节点等的阈值

25
00:01:13,519 --> 00:01:16,259
然后使用交叉验证集

26
00:01:16,260 --> 00:01:19,805
计算每个模型的 F1 得分

27
00:01:19,805 --> 00:01:22,235
并选出效果最好的模型

28
00:01:22,234 --> 00:01:23,834
最后使用测试集

29
00:01:23,834 --> 00:01:25,539
确保该模型很好

30
00:01:25,540 --> 00:01:28,475
如果有多个超参数呢？

31
00:01:28,474 --> 00:01:31,069
这里只有一个超参数 是深度

32
00:01:31,069 --> 00:01:33,479
如果训练支持向量机呢？

33
00:01:33,480 --> 00:01:35,820
在支持向量机中 我们有一些超参数

34
00:01:35,819 --> 00:01:38,759
例如内核 可以是线性或多项式

35
00:01:38,760 --> 00:01:40,620
还有 γ 参数

36
00:01:40,620 --> 00:01:43,430
如果它很小 则结果是这样的

37
00:01:43,430 --> 00:01:44,670
如果很大

38
00:01:44,670 --> 00:01:46,750
则结果是这样的

39
00:01:46,750 --> 00:01:51,135
如何选择最佳内核和 γ 组合？

40
00:01:51,135 --> 00:01:55,365
很简单 我们使用网格搜索法

41
00:01:55,364 --> 00:01:58,809
也就是制作一个表格并列出所有可能的组合 然后选择最佳的组合

42
00:01:58,810 --> 00:02:02,469
这里的列是可以使用的不同内核 包括线性或多项式

43
00:02:02,469 --> 00:02:05,189
行是不同的 γ 值

44
00:02:05,189 --> 00:02:09,599
建议设置几个按指数级增长的值 例如 0.1

45
00:02:09,599 --> 00:02:13,185
1 10 100 1000 等等

46
00:02:13,185 --> 00:02:15,870
我们使用训练集训练多个

47
00:02:15,870 --> 00:02:19,509
具有不同 γ 值的线性模型和多项式模型

48
00:02:19,509 --> 00:02:24,269
然后使用交叉验证集计算这些模型的 F1 得分

49
00:02:24,270 --> 00:02:28,305
并选择 F1 得分最高的模型

50
00:02:28,305 --> 00:02:33,420
最后 使用测试集检测所选的模型效果是否很好

