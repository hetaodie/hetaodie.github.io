WEBVTT

1
00:00:00.000 --> 00:00:02.915
在这部分 我们将学习如何判断是否过拟合

2
00:00:02.915 --> 00:00:04.735
欠拟合以及模型是否效果很好

3
00:00:04.735 --> 00:00:06.750
这是三组数据

4
00:00:06.750 --> 00:00:10.589
我们的数据似乎按照二次方程式很好地分布

5
00:00:10.589 --> 00:00:13.091
我们将尝试拟合三个模型

6
00:00:13.092 --> 00:00:15.690
第一个是线性（一次）模型

7
00:00:15.689 --> 00:00:21.509
效果不是太好 因为欠拟合 所以是个偏差很高的模型

8
00:00:21.510 --> 00:00:26.295
第二个是二次方程式模型 效果不错

9
00:00:26.295 --> 00:00:29.460
第三个是六次多项式

10
00:00:29.460 --> 00:00:33.910
过拟合了 因此是高方差的模型

11
00:00:33.909 --> 00:00:37.539
现在我们将画出一些曲线 以便区分这些模型

12
00:00:37.539 --> 00:00:40.890
先从高偏差线性模型开始

13
00:00:40.890 --> 00:00:42.299
我们先使用几个点训练该模型

14
00:00:42.299 --> 00:00:45.629
然后逐步增加点的数量

15
00:00:45.630 --> 00:00:48.675
如果用四个点训练该模型

16
00:00:48.674 --> 00:00:52.679
那么可以很好地拟合训练集

17
00:00:52.679 --> 00:00:56.542
因此训练误差很小 我们将误差绘制在右侧图表中

18
00:00:56.542 --> 00:00:59.240
但是当我们评估交叉验证数据时

19
00:00:59.240 --> 00:01:02.520
因为只使用四个点训练模型

20
00:01:02.520 --> 00:01:07.040
模型效果不会太好 因此交叉验证的误差肯定很高

21
00:01:07.040 --> 00:01:09.045
我们不会显示交叉验证集

22
00:01:09.045 --> 00:01:12.725
但是你可以想象出该数据的其他随机子集

23
00:01:12.724 --> 00:01:15.164
我们将交叉验证误差绘制在这里

24
00:01:15.165 --> 00:01:19.185
现在增加到 8 个点 再次训练线性模型

25
00:01:19.185 --> 00:01:23.575
训练误差可能会增大一点点 因为拟合八个点比四个点要困难

26
00:01:23.575 --> 00:01:26.894
但是因为模型效果稍微好些 我们使用了更多的数据来训练它

27
00:01:26.894 --> 00:01:30.257
或许交叉验证误差降低了一点点

28
00:01:30.257 --> 00:01:34.250
但是幅度并不大 因为这是一个尝试拟合二次数据的线性模型

29
00:01:34.250 --> 00:01:38.280
这是训练误差和交叉验证误差

30
00:01:38.280 --> 00:01:41.480
现在增多到 12 个点 重新训练模型

31
00:01:41.480 --> 00:01:46.240
同样 训练误差可能会增大一点点 因为有更多的训练数据需要拟合

32
00:01:46.239 --> 00:01:48.780
但是交叉验证误差也会再降低一点点

33
00:01:48.780 --> 00:01:52.019
因为有一个用更多数据进行训练的更好模型了

34
00:01:52.019 --> 00:01:54.829
但是依然不会降低太多

35
00:01:54.829 --> 00:01:57.239
似乎随着点的数量越来越增多

36
00:01:57.239 --> 00:01:59.879
训练误差将不断增大 测试误差

37
00:01:59.879 --> 00:02:02.859
将不断下降 如果画出这两条曲线

38
00:02:02.859 --> 00:02:05.250
它们将越来越接近

39
00:02:05.250 --> 00:02:07.319
或许在某个点还会汇合

40
00:02:07.319 --> 00:02:09.900
汇合的点应该很高

41
00:02:09.900 --> 00:02:14.069
因为这两个模型是欠拟合的 它们的误差不会很小

42
00:02:14.069 --> 00:02:15.509
现在对二次方程式模型执行相同的操作

43
00:02:15.509 --> 00:02:18.929
记住这个模型效果很好

44
00:02:18.930 --> 00:02:21.180
和之前一样 用四个点进行训练

45
00:02:21.180 --> 00:02:24.939
训练集的效果很好 因此训练误差很小

46
00:02:24.939 --> 00:02:27.704
但是只用了非常少的点训练模型

47
00:02:27.705 --> 00:02:30.180
因此交叉验证集的结果可能不太理想

48
00:02:30.180 --> 00:02:33.540
因此交叉验证误差很大

49
00:02:33.539 --> 00:02:36.419
如果将点增多到 8 个

50
00:02:36.419 --> 00:02:40.379
训练误差增大了 因为有更多的点要拟合

51
00:02:40.379 --> 00:02:44.324
但是因为模型用更多的点进行训练 了解的信息更多

52
00:02:44.324 --> 00:02:49.049
所以验证误差下降了 如果使用 12 个点进行训练

53
00:02:49.050 --> 00:02:51.005
出现同样的情况

54
00:02:51.004 --> 00:02:55.394
训练误差增大了 交叉验证误差下降了

55
00:02:55.395 --> 00:03:01.890
和之前一样 这两条曲线越来越接近

56
00:03:01.889 --> 00:03:04.439
但是交点更低

57
00:03:04.439 --> 00:03:07.146
因为模型效果很好 因此误差很小

58
00:03:07.146 --> 00:03:10.465
最后对六次模型执行相同的流程

59
00:03:10.465 --> 00:03:13.300
注意 这个模型会过拟合

60
00:03:13.300 --> 00:03:15.105
用四个点进行训练

61
00:03:15.104 --> 00:03:19.094
同样 我们可以很轻松地拟合四个点 因此训练误差很小

62
00:03:19.094 --> 00:03:22.090
因为该模型了解的信息不多

63
00:03:22.090 --> 00:03:24.789
因此交叉验证集的效果不会很好

64
00:03:24.789 --> 00:03:27.409
因此交叉验证误差很大

65
00:03:27.409 --> 00:03:30.155
现在如果将训练集增大到 8 个点

66
00:03:30.155 --> 00:03:32.460
训练误差稍微大了些

67
00:03:32.460 --> 00:03:36.620
测试误差稍微小了些 和之前一样

68
00:03:36.620 --> 00:03:40.305
如果将训练集增大到 8 个点

69
00:03:40.305 --> 00:03:43.560
那么训练误差稍微大些

70
00:03:43.560 --> 00:03:46.620
交叉验证误差稍微小些

71
00:03:46.620 --> 00:03:50.319
12 个训练点也是一样

72
00:03:50.319 --> 00:03:52.844
但是现在出现了有趣的现象

73
00:03:52.844 --> 00:03:55.169
训练误差始终不会变得太大

74
00:03:55.169 --> 00:03:57.719
因为过拟合的模型在训练集中效果会很好

75
00:03:57.719 --> 00:04:00.319
因为它们可以很好地拟合

76
00:04:00.319 --> 00:04:03.224
交叉验证误差始终不会太低

77
00:04:03.224 --> 00:04:08.609
因为我们看过过拟合的模型在交叉验证集中效果不太好

78
00:04:08.610 --> 00:04:10.305
当我们增多训练点时

79
00:04:10.305 --> 00:04:11.859
这两条曲线将更接近

80
00:04:11.859 --> 00:04:14.070
但是不会汇集成一点

81
00:04:14.069 --> 00:04:16.800
它们之间始终存在一定的距离

82
00:04:16.800 --> 00:04:19.395
总结下 我们有三个模型

83
00:04:19.394 --> 00:04:21.365
高偏差模型 效果好的模型和高方差模型

84
00:04:21.365 --> 00:04:23.670
在高偏差（欠拟合）模型中

85
00:04:23.670 --> 00:04:27.330
两条曲线相互接近并交于一点

86
00:04:27.329 --> 00:04:29.490
在效果好的模型中

87
00:04:29.490 --> 00:04:32.444
曲线同样相互接近并交于一个很低的点

88
00:04:32.444 --> 00:04:34.685
在高方差（过拟合）模型中

89
00:04:34.685 --> 00:04:37.439
曲线没有相互接近

90
00:04:37.439 --> 00:04:40.913
训练集保持很低 交叉验证集保持很高

91
00:04:40.913 --> 00:04:43.215
这样就可以判断是否欠拟合

92
00:04:43.214 --> 00:04:45.739
过拟合或者正常

93
00:04:45.740 --> 00:04:49.660
我们直接查看训练曲线并看看它们的形状

