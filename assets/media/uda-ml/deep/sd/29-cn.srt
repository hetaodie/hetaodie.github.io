1
00:00:02,399 --> 00:00:07,089
我们再来看看另一个示例 仔细了解下交叉熵

2
00:00:07,089 --> 00:00:08,644
假设有三道门

3
00:00:08,644 --> 00:00:11,275
注意 这不是蒙提霍尔问题

4
00:00:11,275 --> 00:00:15,060
有绿色的门 红色的门和蓝色的门

5
00:00:15,060 --> 00:00:18,699
每个门后面都可能有一个礼物

6
00:00:18,699 --> 00:00:23,125
每个门后面有礼物的概率分别是：

7
00:00:23,125 --> 00:00:25,018
第一道门为 0.8 第二道门为 0.7

8
00:00:25,018 --> 00:00:27,088
第三道门为 0.1

9
00:00:27,088 --> 00:00:31,987
例如 绿色门后面有礼物的概率是 80%

10
00:00:31,989 --> 00:00:37,270
没有礼物的概率是 20%

11
00:00:37,270 --> 00:00:38,759
我们可以将这些信息放入表格中

12
00:00:38,759 --> 00:00:41,490
有礼物的概率

13
00:00:41,490 --> 00:00:43,350
放在上面一行

14
00:00:43,350 --> 00:00:47,000
没有礼物的概率放在下面一行

15
00:00:47,000 --> 00:00:49,149
假设我们相对结果进行猜测

16
00:00:49,149 --> 00:00:53,353
我们想知道最可能的情形是什么

17
00:00:53,353 --> 00:00:56,954
假设它们是独立事件

18
00:00:56,954 --> 00:00:59,880
这里 最可能的情形

19
00:00:59,880 --> 00:01:03,215
是通过选择每列最大的概率来获得

20
00:01:03,215 --> 00:01:06,879
对于第一个门 更有可能有礼物

21
00:01:06,879 --> 00:01:09,209
所以我们说第一道门后面有礼物

22
00:01:09,209 --> 00:01:12,629
对于第二道门 也更有可能有礼物

23
00:01:12,629 --> 00:01:15,120
所以我们说第二道门后面有礼物

24
00:01:15,120 --> 00:01:18,040
对于第三道门 更有可能没礼物

25
00:01:18,040 --> 00:01:21,084
所以说第三道门后面没有礼物

26
00:01:21,084 --> 00:01:22,680
因为这些事件是独立的

27
00:01:22,680 --> 00:01:25,560
整个分布的概率是

28
00:01:25,560 --> 00:01:31,349
三个概率的积 即 0.8 x 0.7 x 0.9

29
00:01:31,349 --> 00:01:37,109
结果为 0.504 大概是 50%

30
00:01:37,108 --> 00:01:39,643
我们看看表格里的可能情形

31
00:01:39,644 --> 00:01:43,079
这是表示每道门所有可能情形的表格

32
00:01:43,078 --> 00:01:47,073
共有八种情形 因为每道门有两种可能性

33
00:01:47,075 --> 00:01:49,189
有三道门

34
00:01:49,188 --> 00:01:51,539
和之前一样获得每种分布的概率

35
00:01:51,540 --> 00:01:57,674
即将三个独立概率相乘 获得这些数字

36
00:01:57,674 --> 00:02:00,180
可以发现 这些数字相加等于 1

37
00:02:00,180 --> 00:02:02,670
从上一个视频中 我们了解到

38
00:02:02,670 --> 00:02:05,855
概率对数的负值是交叉熵

39
00:02:05,855 --> 00:02:09,408
我们计算下交叉熵

40
00:02:09,407 --> 00:02:11,472
结果是这些数字

41
00:02:11,473 --> 00:02:14,429
注意 概率高的事件交叉熵低 而概率低的事件交叉熵高

42
00:02:14,430 --> 00:02:20,110
概率低的事件交叉熵也低

43
00:02:20,110 --> 00:02:22,879
例如 第二行的概率是 0.504

44
00:02:22,877 --> 00:02:28,173
交叉熵是 0.69

45
00:02:28,175 --> 00:02:32,319
倒数第二行的概率极低 为 0.006

46
00:02:32,318 --> 00:02:38,769
交叉熵是 5.12

47
00:02:38,770 --> 00:02:41,280
我们来推理下交叉熵公式

48
00:02:41,280 --> 00:02:45,430
这是三道门 示例情形说第一道门和第二道门

49
00:02:45,430 --> 00:02:50,294
后面有一个礼物 第三道门后面没有礼物

50
00:02:50,294 --> 00:02:53,110
这些事件发生的概率是

51
00:02:53,110 --> 00:02:55,905
第一道门后面有礼物的概率是 0.8

52
00:02:55,905 --> 00:02:58,038
第二道门后面有礼物的概率是 0.7

53
00:02:58,038 --> 00:03:01,429
第三道门后面没有礼物的概率是 0.9

54
00:03:01,430 --> 00:03:03,250
我们在计算交叉熵时

55
00:03:03,250 --> 00:03:06,430
算出积对数的负值

56
00:03:06,430 --> 00:03:11,754
也就是因子对数的负值之和

57
00:03:11,752 --> 00:03:16,723
为 -ln(0.8) - ln(0.7) - ln(0.9)

58
00:03:16,723 --> 00:03:20,942
为了推出带有变量的公式

59
00:03:20,943 --> 00:03:24,763
我们称 p1 为第一道门后面有礼物的概率

60
00:03:24,764 --> 00:03:27,840
p2 为第二道门后面有礼物的概率

61
00:03:27,840 --> 00:03:31,685
p2 为第三道门后面有礼物的概率

62
00:03:31,685 --> 00:03:34,139
这里 0.8 是 p1

63
00:03:34,139 --> 00:03:36,465
0.7 是 p2

64
00:03:36,465 --> 00:03:39,009
0.9 是 1-p3

65
00:03:39,008 --> 00:03:40,758
因为没有礼物的概率是

66
00:03:40,758 --> 00:03:44,168
1 减去有礼物的概率

67
00:03:44,169 --> 00:03:48,680
再设定一个变量 叫做 yi

68
00:03:48,680 --> 00:03:53,539
如果第 i 道门后面有礼物 则是 1 如果没有礼物 则是 0

69
00:03:53,538 --> 00:03:56,987
实际上 yi 就是表示第 i 道门后面有礼物的数字

70
00:03:56,989 --> 00:04:04,164
这里 y1=1 y2=1 y3=0

71
00:04:04,163 --> 00:04:07,359
可以综合所有这一切得出交叉熵公式

72
00:04:07,360 --> 00:04:09,120
是这个和

73
00:04:09,120 --> 00:04:12,060
我们看看和里面的这个公式

74
00:04:12,060 --> 00:04:18,139
注意 如果第 i 道门后面有礼物 则 yi=1

75
00:04:18,139 --> 00:04:24,350
所以第一项是 ln(pi) 第二项是 0

76
00:04:24,350 --> 00:04:28,035
类似地 如果第 i 道门后面没有礼物

77
00:04:28,035 --> 00:04:30,300
那么 yi 是 0

78
00:04:30,300 --> 00:04:36,459
所以第一项是 0 这一项是 ln(1-pi)

79
00:04:36,459 --> 00:04:40,105
因此 这个公式完全包含了对数负值的和

80
00:04:40,105 --> 00:04:44,310
正好是交叉熵

81
00:04:44,310 --> 00:04:49,435
交叉熵可以告诉我们两个向量是相似还是不同

82
00:04:49,435 --> 00:04:53,507
例如 如果计算 (1,1,0)

83
00:04:53,507 --> 00:04:58,685
和 (0.8,0.7,0.1) 的交叉熵 结果是 0.69

84
00:04:58,685 --> 00:05:03,550
结果比较小 因为 1,1,0 是和 0.8, 0.7,0.1 相似的向量

85
00:05:03,550 --> 00:05:09,168
意味着根据第二组数字给出的概率

86
00:05:09,170 --> 00:05:11,660
第一组数字得出的礼物分布

87
00:05:11,660 --> 00:05:15,634
有可能发生

88
00:05:15,634 --> 00:05:21,430
但是另一方面 如果计算 (0,0,1) 和 

89
00:05:21,430 --> 00:05:26,959
(0.8, 0.7, 0.1) 的交叉熵 结果是 5.12 很高

90
00:05:26,959 --> 00:05:31,129
这是因为根据第二组数字给出的概率

91
00:05:31,129 --> 00:05:36,180
第一组数字表示的礼物分布不太可能发生

