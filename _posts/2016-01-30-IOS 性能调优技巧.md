---
layout: post
title: IOS性能调优技巧
description: IOS的性能在一个比较大的项目里面是比较重要的，我在这里列举了一些常见的技巧，用来学习。
Keywords: ios 性能
tagline: original post at hetaodie.github.io
categories: [ios]
tags: [IOS优化]

---
* 目录
 {:toc  }
 
##尽量使用ARC

ARC不仅可以帮你避免内存泄露，还可以帮你提高性能，它能保证释放掉不再需要的对象的内存.

##尽量把Views设置成为不透明
如果你有不透明的Views，你应该设置它们的opaque属性为YES。Apple的文档对于为图片设置不透明属性的描述是：
(opaque)这个属性给渲染系统提供了一个如何处理这个view的提示。如果设为YES， 渲染系统就认为这个view是完全不透明的，这使得渲染系统优化一些渲染过程和提高性能。如果设置为NO，渲染系统正常地和其它内容组成这个View。默认值是YES。
在相对比较静止的画面中，设置这个属性不会有太大影响。然而当这个view嵌在scroll view里边，或者是一个复杂动画的一部分，不设置这个属性的话会在很大程度上影响app的性能。
##不要阻塞主线程
永远不要使主线程承担过多。因为UIKit在主线程上做所有工作，渲染，管理触摸反应，回应输入等都需要在它上面完成。
所以除了渲染，触摸，输入，等功能外，其他的功能尽量在子线程中进行处理，特别当处理的逻辑很大，消耗CPU较高的情况下。

##不要在ImageViews中调整图片大小
如果在UIImageVIew中显示一个来自bundle的图片，你应保证图片的大小和UIImageVIew的大小相同。因为在运行中缩放图片是很耗资源的，特别是UIImageVIew嵌套在UIScrollVIew中的情况下。 如果图片是在远端服务器加载的你不能控制图片的大小，你可以在下载完成后，最好用background thread，缩放一次，然后在UIImageView中使用缩放后的图片。

##选择正确的collection
学会选择对业务场合最适合的类或者对象是写出高效代码的基础，一些常见的collections的总结：
* Arrays：有序的一组值。使用index来lookup很快，使用value lookup很慢，插入/删除很慢的。
* Dictionaries：存储键值对。用键来查找比较快。
* Sets：无序的一组值。用值来查找很快，插入/删除很快。

##重用大开销对象
一些objects的初始化很慢，比如NSDateFormatter和NSCalendar。然而，你又不可避免地需要使用它们，比如从JSON或者XML中解析数据。
<P>
下面的代码说明了使用一个属性来延迟加载一个date formatter. 第一次调用时它会创建一个新的实例，以后的调用则将返回已经创建的实例：
{% highlight ruby %}

@property (nonatomic, strong) NSDateFormatter *formatter;

1. - (NSDateFormatter *)formatter
2.  {
3.    if (! _formatter) {
4.       _formatter = [[NSDateFormatter alloc] init];
5.        _formatter.dateFormat = @"EEE MMM dd HH:mm:ss Z yyyy"; 
6.    }
7.    return _formatter;
8.   }

{% endhighlight %}

{% highlight ruby %}
$ sudo tasksel

{% endhighlight %}

select the lamp-server and press 'Ok'. Follow the steps as directed and create your Mysql password.</br>
Lastly,start apache2 server:

{% highlight ruby %}

$ sudo service apache2 restart

{% endhighlight %}

Congratulations you have successfully installed LAMP server on your system. To test just visit your web browser and type in the following url:


<a href="http://localhost/">http://localhost/</a>


To test the php installation:
{% highlight ruby %}

$ sudo nano /var/www/phptest.php

{% endhighlight %}

type in and save:

{% highlight ruby %}

<?php phpinfo(); ?>

{% endhighlight %}

and open the following url in your browser:


<a href="http://localhost/phptest.php">http://localhost/phptest.php</a>